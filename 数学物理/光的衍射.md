#光学 
光的衍射现象与[[光的干涉]]现象就其实质来讲，都是相干光波叠加引起的光强的重新分布。
不同之处在于，干涉现象是有限个相干光波的叠加，而衍射现象则是无限多个相干光波的叠加结果。
因此，对衍射现象的理论处理，从本质上来说与干涉现象相同，但是由于衍射现象的特殊性，在数学上遇到了很大的困难，以至许多问题得不到严格的解，因而，实际的衍射理论都是一些近似解法。
# Huygens-Fersnel原理
- *Huygens原理*：如图所示的波源$S$，在某一时刻所产生波的波阵面为$\Sigma$，则$\Sigma$面上的每一点都可以看做是一个次波源，它们发出球面次波，其后某一时刻的波阵面$\Sigma$，即是该时刻这些球面次波的包络面，波阵面的法线方向就是该波的传播方向（波矢$\vec{k}$方向，在各向同性介质中也即是光线方向）。![[惠更斯原理.png]]
惠更斯原理能够很好地解释光的直线传播，光的反射和折射方向，但不能说明衍射过程及其强度分布。
- *Huygens-Fersnel原理*：菲涅耳在研究了光的干涉现象后，考虑到次波来自于同一光源，应该*相干*，因而波阵面$\Sigma$上每一点的光振动应该是在光源和该点之间任一波面（例如$\Sigma$面）上的各点发出的次波场叠加的结果。

Huygens-Fersnel原理可以解释衍射现象：在任意给定的时刻，任一波面上的点都起着次波波源的作用，它们各自发出球面次波，障碍物以外任意点上的光强分布，即是没有被阻挡的各个次波源发出的次波在该点相干叠加的结果。
![[惠更斯-菲涅尔原理.png]]
根据Huygens-Fersnel原理，如图所示的一个单色光源$S$对于空间任意点$P$的作用，可以看做是$S$和$P$之间任一波面$\Sigma$上各点发出的次波在$P$点相干叠加的结果。假设$\Sigma$波面上任意点$Q$的光场复振幅为$\tilde{E}(Q)$，在$Q$点取一个面元$\mathrm{d}\sigma$，则$\mathrm{d}\sigma$面元上的次波源对$P$点光场的贡献为$$\mathrm{d}\tilde{E}(P)=CK(\theta)\tilde{E}(Q) \frac{e^{ikr}}{r}\mathrm{d}\sigma$$
式中$C$是比例系数，$r=\overline{QP}$，$K(\theta)$为倾斜因子，$e^{ikr}/r$是来自[[波动方程#球坐标系]]下无界解的形式。
或者写作积分形式$$\tilde{E}(P)=\iint_{\Sigma}CK(\theta)\tilde{E}(Q) \frac{e^{ikr}}{r}\mathrm{d}\sigma$$
这被称作*Huygens-Fersnel*公式。
事实上，这个式子只能做到定性描述，其$K(\theta)$的内容全部依靠Fersnel本人的瞎猜和经验公式，解释力非常有限。
# Kirchhoff衍射公式
## Helmholtz-Kirchhoff积分定理
假设有一个单色光波通过闭合曲面$\Sigma$传播，在$t$时刻、空间$P$点的光电场为$$E(P,t)=\tilde{E}(P)e^{-i\omega t}$$
若P点无源，则该光场应该满足[[波动方程]]：$$\nabla^2 E-\frac{1}{c^2} \frac{ \partial^2  E }{ \partial  t^2}=0 $$
代入后可以得到$$\nabla^2 \tilde{E}(P)+k^2 \tilde{E}(P)=0$$
其中$k=\omega/c$，这是个[[位势方程#Helmholtz方程]]，运用[[Green函数法]]，该方程的Green函数是$$\tilde{G}(r)=\frac{1}{4\pi}\frac{e^{ikr}}{r}$$
根据Green函数法的通解公式，因为$\Sigma$围成的曲面内是没有源的，所以解只包含边界贡献的部分$$\tilde{E}(P)=\frac{1}{4\pi}\iint_{\Sigma}\kern{-18.8pt}\subset\kern{-2pt}\supset  \left[ \left( \frac{e^{ikr}}{r} \right)\frac{ \partial  \tilde{E}(\vec{r}) }{ \partial  n} -\tilde{E}(\vec{r})\frac{ \partial     }{ \partial  n} \left( \frac{e^{ikr}}{r} \right)\right]  \mathrm{d}\sigma$$
这就是*Helmholtz-Kirchhoff积分定理*。
## Kirchhoff衍射公式
![[基尔霍夫衍射公式.png]]
如图所示，有一个无限大的不透明平面屏，其上有一开孔$\Sigma$，用点光源$S$照明，并设$\Sigma$的线度$δ$满足$$\lambda < δ \ll \min(r,l)$$
为求$P$点的光场，围绕$P$点作一闭合曲面。
该闭合曲面由三部分组成：
- 开孔$\Sigma$；
- 不透明屏的部分背面$\Sigma_{1}$；
- 以$P$点为中心、$R$为半径的大球的部分球面$\Sigma_{2}$。

然后，$P$点的光场复振幅可以表示为
$$\tilde{E}(P)=\frac{1}{4\pi}\iint_{\Sigma+\Sigma_{1}+\Sigma_{2}}\kern{-45.8pt}\subset\kern{-2pt}\supset \quad\quad\quad \left[ \left( \frac{e^{ikr}}{r} \right)\frac{ \partial  \tilde{E}(\vec{r}) }{ \partial  n} -\tilde{E}(\vec{r})\frac{ \partial     }{ \partial  n} \left( \frac{e^{ikr}}{r} \right)\right]  \mathrm{d}\sigma$$

---
Kirchhoff假定：
1. 在$\Sigma$面上，$\tilde{E}$和$\partial\tilde{E}/\partial n$和不存在屏幕时完全相同。因此$$\tilde{E}=\frac{A}{l}e^{ikl},\quad \frac{ \partial  \tilde{E} }{ \partial  n} =\cos\langle \vec{n},\vec{l} \rangle \left( ik-\frac{1}{l} \right) \frac{A}{l}e^{ikl}$$其中$A$是距离光源单位距离处的振幅，$\cos\langle \vec{n},\vec{l} \rangle$是$\vec{n},\vec{l}$张成的夹角的余弦
2. 在不透明的背面$\Sigma_{1}$上，光全部被挡住，不为后面的衍射做贡献。因此$\tilde{E}=0,\quad\partial\tilde{E}/\partial n=0$。

这两个假定都是近似的，因为屏的存在必然会干扰$\Sigma$处的场，特别是开孔边缘附近的场，不透光的背面也并非处处为0。
但是严格的衍射理论表明，在上述开孔线度的限制下，误差并不大，作为近似理论处理，仍然可以采用这种假定。

---
对于$\Sigma_{1}$面， Kirchhoff的假定把它掐死了，这部分的积分直接就是0。
对于$\Sigma_{2}$面，$r=R,\cos\langle \vec{n},\vec{R} \rangle =1$，且因为$R\gg 1$有
$$\frac{ \partial   }{ \partial  n} \left( \frac{e^{ikR}}{R} \right)=\left( ik-\frac{1}{R} \right) \frac{e^{ikR}}{R} \approx ik \frac{e^{ikR}}{R}$$
因此$\Sigma_{2}$上的积分为
$$\frac{1}{4\pi}\iint_{\Sigma_{2}} \frac{e^{ikR}}{R}\left( \frac{ \partial  \tilde{E} }{ \partial  n} -ik \tilde{E} \right)\mathrm{d}\sigma=\frac{1}{4\pi}\iint_{\Omega} \frac{e^{ikR}}{R}\left( \frac{ \partial  \tilde{E} }{ \partial  n} -ik \tilde{E} \right)R^2\mathrm{d}\omega$$
其中$\Omega$是$\Sigma_{2}$对$P$张成的立体角，$\mathrm{d}\omega$是立体角元。
因为[[波动方程#Sommerfeld辐射条件]]，当$R\to \infty$时（圈起的范围$R$取得足够大），上面的积分也是趋于0的。

---
所以三个面的面积分实际上只需要考虑$\Sigma$的部分。
又因为
$$\frac{ \partial  \tilde{G} }{ \partial n } =\cos \langle \vec{n},\vec{r} \rangle \frac{ \partial  \tilde{G} }{ \partial  r} ,\quad (把\hat{r}方向的函数转到\hat{n}方向)$$
把Kirchhoff假设的第一条带进去，略去$1/r,1/l$（比$k$小得多），得到
$$
\boxed{\tilde{E}(P)=-\frac{i}{\lambda}\iint_{\Sigma}  \left[ \frac{\cos\langle \vec{n},\vec{r} \rangle -\cos\langle \vec{n},\vec{l} \rangle }{2} \right]\tilde{E}(l) \frac{e^{ikr}}{r}\mathrm{d}\sigma}
$$
此式称为*Fersnel-Kirchhoff衍射公式*。
和Huygens-Fersnel公式
$$\tilde{E}(P)=\iint_{\Sigma}CK(\theta)\tilde{E}(Q) \frac{e^{ikr}}{r}\mathrm{d}\sigma$$对比可以发现，
$$
\begin{equation}
\left\{
\begin{aligned}
&C=-\frac{i}{\lambda}\\
&K(\theta)=\left[ \frac{\cos\langle \vec{n},\vec{r} \rangle -\cos\langle \vec{n},\vec{l} \rangle }{2} \right]\\
&\tilde{E}(Q)=\tilde{E}(l)=\frac{A}{l}e^{ikl}\\
\end{aligned}
\right.
\end{equation}
$$
这为Huygens-Fersnel公式提供了定量的解释，弥补了原来只能定性描述的缺陷。
## Kirchhoff衍射的重要结论
### Helmholtz 互易定理
从Fresnel-Kirchhoff衍射公式可以看出，*该式对于光源和观察点是对称的*。
这意味着S点处的点源在P点产生的效果，跟P点处的点源在S点处产生的效果是一样的。
### Babinet定理
*互补屏*：指两个衍射屏，一个屏透光的部分刚好对应另一个屏不透光的部分。
假设$\tilde{E}_{1}(P)$和$\tilde{E}_{2}(P)$分别表示两个衍射屏$\Sigma_{1}$和$\Sigma_{2}$透光部分的积分，而两个透光部分加起来刚好是整个平面。这时$$\tilde{E}_{0}(P)=\tilde{E}_{1}(P)+\tilde{E}_{2}(P)$$
这意味着两个互补屏在衍射场中某点单独产生的光场复振幅之和，等于无衍射屏时光波自由传播时在该点的光场复振幅。
# Kirchhoff衍射公式的近似
确定衍射问题的严格解是非常困难的，为此必须根据实际情况对Kirchhoff衍射公式做近似处理。
## 傍轴近似
一般光学系统中，对成像起主要作用是跟光学系统的光轴夹角很小的傍轴光线。
这个时候成立两个近似条件：
1. $\cos \langle \vec{n},\vec{r} \rangle\approx 1$，考虑平行光入射时$\cos \langle \vec{n},\vec{l} \rangle=-1$，$K(\theta)\approx 1$；
2. 角向变化对位矢变化影响不大，$r\approx z_{1}$；
![[傍轴近似衍射.png]]

以上，Kirchhoff衍射公式可以简化为
$$\tilde{E}(P)=- \frac{i}{\lambda z_{1}}\iint_{\Sigma}\tilde{E}(Q)e^{ ikr }\mathrm{d}\sigma$$
在这里，指数中的$r$未用$z_{1}$代替，这是因为指数中的$r$影响的是次波场的相位，$r$的微小变化都会影响相位的很大变化，会对干涉效应产生显著的影响，不可直接用$z_{1}$代替。
## 距离近似
### 衍射区的划分
![[衍射现象随距离改变.png]]
为了对距离的影响有一明确的概念，首先考察单色平面光波经过衍射小孔后的衍射现象。
上图表示一个单色平面光波垂直照射圆孔∑的衍射情况。
若在离$\Sigma$很近的$K_{1}$处观察透过的光，将看到边缘比较清晰的光斑，其形状、大小和圆孔基本相同，可以看做是圆孔的投影，这时光的传播大致可以看做是直线传播。
若距离再远些，例如在$K_{2}$面上观察时，将看到一个边缘模糊的稍微大些的圆光斑，光斑内有一圈圈的亮暗环，这时已不能看做是圆孔的投影了。
随着观察平面距离的增大，光斑范围不断扩大，但光斑中圆环数逐渐减少，而且环纹中心表现出从亮到暗，又从暗到亮的变化。
当观察平面距离很远时，如在$K_{4}$位置，将看到一个较大的中间亮、边缘暗，且在边缘外有较弱的亮、暗圆环的光斑。
此后，观察距离再增大，只是光斑扩大，但光斑形状不改变。
由此可以将衍射区划分为：
1. 几何投影区：衍射效应可以忽略，光几乎延直线传播（如$K_{1}$所在的位置）；
2. 近场衍射区：衍射效应不能忽略，并且会随距离显著变化（如$K_{2},K_{3}$所在的位置）；
3. 远场衍射区：衍射效应不能忽略，并且不会随距离显著变化（如$K_{4}$所在的位置）。

通常也会将衍射区划分为：
- Fresnel衍射区       = 近场衍射区 + 远场衍射区
- Fraunhofer衍射区 = 远场衍射区
### Fresnel近似
依然是傍轴近似的那张图，我们设$\overline{QP}=r$，则$$r=\sqrt{ z_{1}^2+(x-x_{1})^2+(y-y_{1})^2 }=z_{1}\sqrt{ 1+ \frac{(x-x_{1})^2+(y-y_{1})^2}{z_{1}^2}}= z_{1}\left(1 + \frac{1}{2!}\frac{(x-x_{1})^2+(y-y_{1})^2}{z_{1}^2}+\dots \right)$$
当$z_{1}$大到$$ \frac{[(x-x_{1})^2+(y-y_{1})^2]^2_{\max}}{\lambda} \ll 4z_{1}^3$$时，泰勒展开的高阶项都可以省略，简化为$$r=z_{1}\left(1 + \frac{1}{2!}\frac{(x-x_{1})^2+(y-y_{1})^2}{z_{1}^2} \right)$$Fresnel近似下，$P$点光场为$$\tilde{E}(x,y)= - \frac{i}{\lambda z_{1}}\iint_{\Sigma} \tilde{E}(x_{1},y_{1})e^{ ikz_{1}\left(1 + \frac{1}{2}\frac{(x-x_{1})^2+(y-y_{1})^2}{z_{1}^2} \right) }\mathrm{d}x_{1}\mathrm{d}y_{1}$$
### Fraunhofer近似
Fresnel近似下的已经有
$$r=z_{1}\left(1 + \frac{1}{2!}\frac{(x-x_{1})^2+(y-y_{1})^2}{z_{1}^2} \right)=z_{1}+ \frac{x^2+y^2}{2z_{1}}- \frac{x_{1}x+y_{1}y}{z_{1}}+ \frac{x_{1}^2+y_{1}^2}{2z_{1}}$$
如果还有观察屏距离孔的距离非常大$$\boxed{\frac{(x_{1}^2+y_{1}^2)_{\max}}{\lambda}\ll z_{1}}$$则$r$可以进一步简化为$$r=z_{1}+ \frac{x^2+y^2}{2z_{1}}- \frac{x_{1}x+y_{1}y}{z_{1}}$$在Fraunhofer近似下，$P$点光场为$$\tilde{E}(x,y)= - \frac{ie^{ ikz_{1} }}{\lambda z_{1}}e^{ ik \frac{x^2+y^2}{2z_{1}} }\iint_{\Sigma} \tilde{E}(x_{1},y_{1})e^{ ik \frac{x_{1}x+y_{1}y}{z_{1}} }\mathrm{d}x_{1}\mathrm{d}y_{1}$$一般在Fraunhofer近似下可以得到解析解，但是Fresnel近似下只能得到近似解。
# 重要衍射现象
[[Fraunhofer衍射]]
[[Fresnel衍射]]
[[光栅衍射]]