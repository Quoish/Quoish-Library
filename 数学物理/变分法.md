#分析力学 #泛函分析 #数理方法 
变分法是数学中研究泛函极值的核心工具。
其核心思想是，通过对函数施加微小扰动$y\to y+\varepsilon \eta(x)$，研究泛函增量的变化，凭借取极值的条件，获得函数的表达式。
最早该方法可以溯源到对最速降线问题的研究。
质量为$m$的小球在重力加速度$g$的作用下从沿着光滑轨道从$P(x_{1},y_{1})$自由下滑运动到$Q(x_{2},y_{2})$，当轨道为什么曲线时，运动的耗时最短？这就是最速降线问题。
可以列写出总时间$T$满足
$$T=\int_{0}^T \mathrm{d}t=\int_{0}^l \frac{\mathrm{d}s}{v}=\int_{x_{1}}^{x_{2}} \frac{\sqrt{ (\mathrm{d}x)^2+(\mathrm{d}y)^2}}{v}=\int_{x_{1}}^{x_{2}} \frac{\sqrt{ 1+\dot{y}^2 }}{v}\mathrm{d}x $$
由于能量守恒定律$mgy=\frac{1}{2}mv^2$又有
$$T=\int_{x_{1}}^{x_{2}} \frac{\sqrt{ 1+\dot{y} }}{\sqrt{ 2gy }}\mathrm{d}x$$
其中可以视这个关系式是一个从函数$y(x)$到常量$T$的映射，也就是泛函。
试对$y(x)$添加微小扰动$\tilde{y}(x)=y(x)+\varepsilon \eta(x)$，其中$\varepsilon$是常量，$\eta(x)$是任意的扰动函数，该扰动函数满足$\eta(x_{1})=\eta(x_{2})=0$。
进一步设泛函
$$\Gamma(\tilde{y})=\int_{x_{1}}^{x_{2}} \frac{\sqrt{ 1+\tilde{\dot{y}}^2 }}{v}\mathrm{d}x =\int_{x_{1}}^{x_{2}}F(x,\tilde{y},\tilde{\dot{y}})\mathrm{d}x$$
显然$$\Gamma(y)=T$$
接下来对$\Gamma(\tilde{y})$做进一步讨论
# Euler-Lagrange方程
为使问题在更广泛的意义上成立，我们考虑更一般的情况，对于任意的$F(x,\tilde{y},\tilde{\dot{y}})$设泛函$$\Gamma(\tilde{y})=\int_{x_{1}}^{x_{2}}F(x,\tilde{y},\tilde{\dot{y}})\mathrm{d}x$$其中依然$\tilde{y}(x)=y(x)+\varepsilon \eta(x)$，$y(x)$是最优解，$\varepsilon$是常量，$\eta(x)$是任意的扰动函数，该扰动函数满足$\eta(x_{1})=\eta(x_{2})=0$。
不难发现，因为$\tilde{y},\tilde{\dot{y}}$都是$x$的函数，$\Gamma(\tilde{y})$在经过对$x$积分之后，剩下的变量只有$\varepsilon$，故可设函数
$$I(\varepsilon)=\Gamma(\tilde{y})$$
当取$I(\varepsilon)$极值的时候（$\tilde{y}=y$时），必然有
$$ \left. \frac{ \mathrm{d}  I }{ \mathrm{d}  \varepsilon} \right|_{\varepsilon=0}=0 $$
这个条件也可以表示为
$$\delta \Gamma(\tilde{y}) =0$$
于是
$$
\begin{align}
\frac{ \mathrm{d}  I }{ \mathrm{d}  \varepsilon} &=\int_{x_{1}}^{x_{2}}\frac{ \partial  F }{ \partial  \varepsilon} \mathrm{d}x=\int_{x_{1}}^{x_{2}}\left( \frac{ \partial  F }{ \partial  x} \cdot \frac{ \partial  x }{ \partial  \varepsilon} +\frac{ \partial  F }{ \partial  \tilde{y}}\cdot \frac{ \partial  \tilde{y} }{ \partial  \varepsilon} + \frac{ \partial  F }{ \partial  \tilde{\dot{y}}}\cdot \frac{ \partial  \tilde{\dot{y}} }{ \partial  \varepsilon} \right)\mathrm{d}x \\
&=\int_{x_{1}}^{x_{2}}\left( \frac{ \partial  F }{ \partial  \tilde{y}} \eta(x) +\frac{ \partial  F }{ \partial  \tilde{\dot{y}}} \dot{\eta}(x) \right)\mathrm{d}x
\end{align}
$$
代入$\varepsilon=0$后
$$
\left. \frac{ \mathrm{d}  I }{ \mathrm{d}  \varepsilon}  \right|_{\varepsilon=0} =\int_{x_{1}}^{x_{2}}\left( \frac{ \partial  F }{ \partial  y} \eta(x) +\frac{ \partial  F }{ \partial  \dot{y}} \dot{\eta}(x) \right)\mathrm{d}x
$$
其中第二项利用分部积分法有
$$\int_{x_{1}}^{x_{2}}\frac{ \partial  F }{ \partial  \dot{y}} \dot{\eta}(x)\mathrm{d}x=\int_{x_{1}}^{x_{2}}\frac{ \partial  F }{ \partial  \dot{y}} \mathrm{d}\eta=\left.\frac{ \partial  F }{ \partial  \dot{y}}   \right|_{x_{1}}^{x_{2}}-\int_{x_{1}}^{x_{2}}\eta(x)\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  y}  \right)\mathrm{d}x =-\int_{x_{1}}^{x_{2}}\eta(x)\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  y}  \right)\mathrm{d}x$$
于是
$$\left. \frac{ \mathrm{d}  I }{ \mathrm{d}  \varepsilon}  \right|_{\varepsilon=0} =\int_{x_{1}}^{x_{2}}\left[ \frac{ \partial  F }{ \partial  y} \eta(x)-\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  \dot{y}}  \right) \eta(x)\right]\mathrm{d}x=\int_{x_{1}}^{x_{2}}\left[ \frac{ \partial  F }{ \partial  y} -\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  \dot{y}}  \right) \right]\eta(x)\mathrm{d}x=0$$

因为这个等于0是对任意满足$\eta(x_{1})=\eta(x_{2})=0$的$\eta(x)$都成立的，所以有
$$\frac{ \partial  F }{ \partial  y} -\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  \dot{y}}  \right) =0$$
这就是Euler-Lagrange方程第一形式。
进一步注意到
$$\frac{ \mathrm{d}  F }{ \mathrm{d}  x} =\frac{ \partial  F }{ \partial  x} \cdot 1+\frac{ \partial  F }{ \partial  y} \cdot \dot{y} + \frac{ \partial  F }{ \partial  \dot{y}} \cdot \dot{y}\dot{}$$
$$\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \dot{y}\frac{ \partial  F }{ \partial  \dot{y}}  \right)=\dot{y}\dot{}\frac{ \partial  F }{ \partial  \dot{y}} +\dot{y}\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  \dot{y}}  \right)$$
两式相减
$$\frac{ \mathrm{d}  F }{ \mathrm{d}  x} -\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \dot{y}\frac{ \partial  F }{ \partial  \dot{y}}  \right)=\frac{ \partial  F }{ \partial  x} +\dot{y}\left[ \frac{ \partial  F }{ \partial  y} -\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( \frac{ \partial  F }{ \partial  \dot{y}}  \right) \right]=\frac{ \partial  F }{ \partial  x} +0$$
由此得到
$$\frac{ \mathrm{d}   }{ \mathrm{d}  x} \left( F-\dot{y}\frac{ \partial  F }{ \partial  \dot{y}}  \right)=\frac{ \partial  F }{ \partial  x} $$
这就是Euler-Lagrange方程第二形式。
# 最速降线问题
在最速降线问题中，$$F(x,y,\dot{y})= \sqrt{ \frac{1+\dot{y}^2}{2gy} }$$
利用Euler-Lagrange方程第二形式再求解有
$$\frac{1}{\sqrt{ 1+\dot{y}^2 }}=C\sqrt{ 2gy }$$
进一步$k=\frac{C}{2g}$，在保证$C$取值能满足$k>y$的情况下，原式可化为
$$\sqrt{ \frac{k-y}{y} }=\frac{ \mathrm{d}  y }{ \mathrm{d}  x} $$
之后就是求解积分$$x=\int \sqrt{ \frac{y}{k-y} }\mathrm{d}y$$
这里可以用第二类换元积分法，设$y=k\sin^2 \varphi$，然后又令$\theta=2\varphi$最终解得
$$\begin{cases}
x=\frac{k}{2}(\theta-\sin \theta) \\
y=\frac{k}{2}(1-\cos \theta)
\end{cases}$$
这是摆线的参数方程。
# 光沿直线传播
平面上从点$P(x_{1},y_{1})$到点$Q(x_{2},y_{2})$长度最短的路径是什么样的曲线？
均匀介质中光的光程正比于路径，而依据[[光的传播#Fermat原理]]，光在两点之间选择光程最短的路径传播。于是上面那个问题也可以转换成两点间光传播的路径是什么样的曲线。
可以计算曲线长度
$$L=\int \mathrm{d}s=\int_{x_{1}}^{x_{2}}\sqrt{ 1+\dot{y} ^2}\mathrm{d}x$$
相应设泛函
$$\tilde{L}=\int_{x_{1}}^{x_{2}}\sqrt{ 1+\tilde{\dot{y}} ^2}\mathrm{d}x$$
其中依然$\tilde{y}(x)=y(x)+\varepsilon \eta(x)$，$y(x)$是最优解，$\varepsilon$是常量，$\eta(x)$是任意的扰动函数，该扰动函数满足$\eta(x_{1})=\eta(x_{2})=0$。
Fermat原理可以表述为
$$\delta \tilde{L}=0$$
令$F(x,y,\dot{y})=\sqrt{ 1+\dot{y} ^2}$，这等价于Euler-Lagrange方程第二形式，求解可得
$$\frac{1}{\sqrt{ 1+ \dot{y}^2 }}=C$$
于是
$$\dot{y} =\mathrm{Const}$$
这说明曲线是个直线。
# 最小作用量原理
分析力学中的作用量表示为
$$s=\int_{t_{1}}^{t_{2}} \mathcal{L}(q,\dot{q},t)\mathrm{d}t$$
其中$\mathcal{L}$为Lagrange量。
最小作用量原理即
$$\delta s=0$$
同样可以得到其Euler-Lagrange方程的表达形式
$$\frac{ \partial  \mathcal{L} }{ \partial  q} -\frac{ \mathrm{d}   }{ \mathrm{d}  t} \left( \frac{ \partial  \mathcal{L} }{ \partial  \dot{q}}  \right)=0$$
