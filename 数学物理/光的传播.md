#光学 
光的传播本质上是能量的传播，光路本质上是能量的传播路径，光的传播方向主要取决于[[电磁波的基本性质#坡印廷定理|坡印廷矢量]]。
- *光线*：是在几何光学中，为了简化光的能量在空间中传播方向而引入的模型，被抽象成没有直径也没有体积的几何线，其切线方向就是光波能量传播方向。
- *光束*：同一波面的光线束称作光束。
- *光路*：用光线表示的传播路径，被称作光路。
- *光束截面*：一个点光源发出的光线有无数条，不可能对每一条光线都求出其光路，几何光学的做法是从光束中取出一个适当的截面，求出其上的几条光线的光路，这种截面称作光束截面
# 均匀介质中的传播
光在均匀介质中是沿直线传播的。
从波动光学的角度来看，这可以基于[[Maxwell方程组]]推出电磁场满足波动方程得出。
从几何光学的角度看，这可以基于Fermat原理经由[[变分法]]得出。
## Fermat原理
光传播的路径是光程取极值的路径，即
$$\delta L=0$$
这被称作*Fermat原理*。
其中光程定义为
$$L = \int n \mathrm{d}s$$
即是对折射率$n$的路径积分。
### 极小值的情况
这是最常见的情况。例如，光在均匀介质中的直线传播，或光在平面镜上的反射，光程通常是最小值。
### 极大值的情况
光程取极大值的情况通常发生在光遇到凸面镜或某些凹面镜配置时。
凸面镜反射的情景中，假设点A和点B是固定的，光从A点出发，经凸面镜反射后到达B点。实际反射路径满足反射定律，但如果我们考虑镜面上的邻近点，这些点可能更靠近A和B的直线，因此邻近路径的光程可能更短。这意味着实际路径的光程比周围路径都长，因此是极大值。数学上，光程函数$L = |AP| + |PB|$（其中P是镜面上的点）在实际路径处的二阶导数为负，从而确认是极大值。
### 拐点的情况
光程取拐点的情况通常发生在光学系统具有对称性或光程函数在某些点平坦时。例如：
- 椭圆镜面反射：椭圆有两个焦点A和B。从A点出发的光经椭圆镜面反射后必然到达B点，且所有路径的光程都相等（因为椭圆的性质：|AP| + |PB| = 常数）。因此，光程函数是常数，变分为零，但既不是极小值也不是极大值，而是驻点中的一种特殊情况（平坦点）。在这种情况下，任何微小扰动路径的光程都不变，所以光程函数在该点具有零曲率，类似于拐点。
- 球面镜的曲率中心：如果点A和点B都位于球面镜的曲率中心上，那么从A到镜面上任意点P再到B的光程都相等（因为|AP| + |PB| = 2R，其中R是曲率半径）。同样，光程是常数，变分为零，但无极值。
## Malus-Dupin定理
一束光线（光线集合）若在某个波面上正交（即垂直于该波面），那么这些光线在经过任意次反射和折射后，所形成的出射光束仍然会与另一个新的波面正交。
入射波面与出射波面对应点之间的光程为定值。
这被称为*Malus-Dupin定理*。
# 反射定律和折射定律
光在不同介质中传播，需要满足反射定律和折射定律，这两个定律可以统一使用Snell定律描述。
## 波动光学的理解
从波动光学的角度，假设入射光、反射光、折射光的表达式分别是
$$\vec{E}_{i}(\vec{r},t)=\vec{E}_{0i}e^{i(\vec{k}_{i}\cdot \vec{r}-\omega_{i} t)},\quad \vec{E}_{r}(\vec{r},t)=\vec{E}_{0i}e^{i(\vec{k}_{r}\cdot \vec{r}-\omega_{r} t)},\quad \vec{E}_{t}(\vec{r},t)=\vec{E}_{0i}e^{i(\vec{k}_{t}\cdot \vec{r}-\omega_{t} t)}$$
反射面为$z=0$，根据[[电磁场的边界条件#电场边界条件]]，代入可以得到$$\vec{n}\times(\vec{E}_{0i}e^{i(\vec{k}_{i}\cdot \vec{r}-\omega_{i}t)}+\vec{E}_{0r}e^{i(\vec{k}_{r}\cdot \vec{r}-\omega_{r}t)}-\vec{E}_{0t}e^{i(\vec{k}_{t}\cdot \vec{r}-\omega_{t}t)})\left. \right|_{z=0}= 0$$
因为这个等式要对任意$\vec{r}$和$t$成立，必要的条件就是各个分量的相位都要相等，即
$$\vec{k}_{i}\cdot \vec{r}-\omega_{i}t\left. \right|_{z=0}=\vec{k}_{r}\cdot \vec{r}-\omega_{r}t\left. \right|_{z=0}=\vec{k}_{t}\cdot \vec{r}-\omega_{t}t\left. \right|_{z=0}$$
于是$$
\begin{cases} 
\omega_{i}=\omega_{r}=\omega_{t}\\
k_{ix}=k_{rx}=k_{tx} \\
k_{iy}=k_{ry}=k_{ty}
\end{cases}$$
这里面没有$z$分量是因为$z=0$时$\vec{r}=x \hat{i}+y \hat{j}$。
设光入射光、反射光、折射光和反射平面的夹角为$\theta_{i},\theta_{r},\theta_{t}$。
易知$$k_{i}\sin \theta_{i}=|k_{ix}\hat{i}+k_{iy}\hat{j}|,\quad k_{r}\sin \theta_{r}=|k_{rx}\hat{i}+k_{ry}\hat{j}|,\quad k_{t}\sin \theta_{t}=|k_{tx}\hat{i}+k_{ty}\hat{j}|$$
于是
$$k_{i}\sin \theta_{i}=k_{r}\sin \theta_{r}=k_{t}\sin \theta_{t}$$
对于反射光
$$k_{i}=\frac{\omega_{i}n_{1}}{c}=\frac{\omega_{r}n_{1}}{c}=k_{r}$$
就可以得到*反射定律*
$$\theta_{i}=\theta_{r}$$
对于折射光
$$k_{i}=\frac{\omega_{i}n_{1}}{c}=\frac{\omega_{t}n_{2}}{c}=k_{t}$$
就可以得到*折射定律*（又有Snell定律）
$$n_{1}\sin \theta_{i}=n_{2}\sin \theta_{t}$$
*反射定律在数学形式上即是Snell定律在折射率满足$n_{1}=-n_{2}$条件下的特例*。
## 几何光学的理解
根据Fermat原理：
对于反射问题，这是一个将军饮马问题，通过几何关系易得$$\theta_{i}=\theta_{r}$$
对于折射问题，这是一个优化问题，根据几何关系列写方程，然后求最值就可以得到。
$$n_{1}\sin \theta_{i}=n_{2}\sin \theta_{t}$$
折射定律和反射定律的等式左右两边完全对称，这说明*光路可逆*。
# 反射、折射的振幅特性
## s、p分量
在折射与反射中，为了方便区分，基于入射面（传播方向和法线：
把电矢量垂直于入射面振动的分量称作s分量（Senkrecht，德语：垂直）
把电矢量平行于入射面振动的分量称作p分量（Pararrel，德语：平行）
![[sp分量.png]]
## Fresnel公式
设各介质中电场矢量其s、p分量的表达式为
$$E_{lm}=E_{0lm}e^{i(\vec{k}\cdot \vec{r}-\omega t)},\quad l=i,r,t,\quad m=s,p$$
则定义s分量、p分量的反射、透射系数分别为
$$r_{m}=\frac{E_{0rm}}{E_{0im}},\quad t_{m}=\frac{E_{0tm}}{E_{0im}}$$
根据入射角$\theta_{1}$折射角$\theta_{2}$计算反射和透射系数的公式，称作*Fresnel公式*
$$
\begin{equation}
\left\{
\begin{aligned}
&r_{s}= \frac{n_{1} \cos \theta_{1}-n_{2} \cos \theta_{2}}{n_{1}\cos \theta_{1}+n_{2}\cos \theta_{2}}\\
&r_{p}= \frac{n_{2}\cos \theta_{1}-n_{1}\cos \theta_{2}}{n_{2}\cos \theta_{1}+n_{1}\cos \theta_{2}}\\
&t_{s}= \frac{2n_{1}\cos \theta_{1}}{n_{1}\cos \theta_{1}+n_{2}\cos \theta_{2}}\\
&t_{p}= \frac{2n_{1}\cos \theta_{1}}{n_{2}\cos \theta_{1}+n_{1}\cos \theta_{2}}\\
\end{aligned}
\right.
\end{equation}$$
若有一个平面光波仪入射角$\theta_{l}$入射到介质分界面上，平面光波的光强为$I_{l}$，则每秒入射到界面上单位面积的能量为
$$W_{l}=I_{l}\cos \theta_{l}$$
所以入射光、反射光、折射光的功率表达式为
$$W_{i}=\frac{1}{2}\sqrt{ \frac{\varepsilon_{1}}{\mu_{0}} }E_{0i}^2 \cos \theta_{i},\quad W_{r}=\frac{1}{2}\sqrt{ \frac{\varepsilon_{1}}{\mu_{0}} }E_{0r}^2 \cos \theta_{r}, \quad W_{t}=\frac{1}{2}\sqrt{ \frac{\varepsilon_{2}}{\mu_{0}} }E_{0i}^2 \cos \theta_{t}$$
由此得到反射率、透射率的表达式
$$R=\frac{W_{r}}{W_{i}}=r^2,\quad T=\frac{W_{t}}{W_{i}}=\frac{n_{2}\cos \theta_{t}}{n_{1}\cos \theta_{i}}t^2$$
显然有
$$R_{s}+T_{s}=1,\quad R_{p}+T_{p}=1$$
综上所述，光在介质上的反射、折射性质由三个因素决定：
- 入射光的偏振态
- 入射角
- 界面两侧的折射率
![[反射率随入射角变化.png]]

下图是当从$n=1$的介质中入射时$R$的变化情况。
![[反射率随折射率变化.png]]
### 薄膜的Fresnel公式
对于如下图的薄膜传播中，设关于第一个薄膜的变量不带撇，第二个带撇，有以下重要结论：
1. $r_{s}=-r_{s}'$；
2. $r_{p}=-r_{p}'$；
3. $t_{s}t_{s}'+r_{s}^2=1$；
4. $t_{p}t_{p}'+r_{p}^2=1$；
5. $t_{p}t_{p}'-r_{p}r_{p}'=1$；
![[薄膜的菲涅尔公式.png]]
## Brewster角
当入射角为$\theta_{i}=\theta_{B}$时，$R_{s}$和$R_{p}$相差最大，且$R_{p}=0$，反射光中将不存在p分量。
此时根据Fresnel公式可以计算出$\theta_{B}+\theta_{t}=90\degree$，同时$$\tan \theta_{B}=\frac{n_{2}}{n_{1}}$$
这个角称作*Brewster角*。
## 全反射角
当$n_{1}>n_{2}$时，若$\theta_{i}>\theta_{C}$，光波发生全反射，可以发现临界条件时$\theta_{t}=90\degree$，由此可以推出
$$\sin \theta_{C}=\frac{n_{2}}{n_{1}}$$
此时的入射角$\theta_{C}$被称作*全反射角*。
# 反射、折射的相位特性
## 折射光与入射光
因为透射系数$t$总是取正值，因此：
- 折射光与入射光总是同相位
## 反射光与入射光
### s分量
- 由光疏介质射向光密介质时（$n_{1}<n_{2}$），$r_{s} <0$，会发生半波损失，出现$\pi$相位的突变。
- 由光密介质射向光疏介质时（$n_{1}>n_{2}$），$r_{s} >0$，不会发生半波损失，与入射光同相位。
- 可以理解为由光疏介质射向光密介质时，光线撞到了一堵硬墙，导致撞懵了，出现了半波损失，由光密介质射向光疏介质时，撞到的是一堵软墙，就不会出现半波损失。
### p分量
- 当入射角小于$\theta_{B}$时，与s分量的表现相反。
- 当入射角大于$\theta_{B}$时，与s分量的表现相同。
### 合成光
小角度入射时：
若光疏介质射向光密介质，$r_{s}<0,r_{p}>0$，合成的光矢量和原来的相反。故会半波损失。
若光密介质射向光疏介质，$r_{s}>0,r_{p}<0$，合成的光矢量与原来的相同。不会半波损失。
大角度入射时：（没有全反射）
若光疏介质射向光密介质，$r_{s}<0,r_{p}<0$，合成的光矢量和原来的相反。故会半波损失。
若光密介质射向光疏介质，$r_{s}>0,r_{p}>0$，合成的光矢量与原来的相同。不会半波损失。
>总结：若$r_{s}<0$，也就是由光疏介质射向光密介质时，才会发生半波损失。


![[反射折射的相位特性.png]]
# 反射、折射的偏振特性
## 自然光
反射光的偏振度为
$$P_{r}=\left| \frac{R_{s}-R_{p}}{R_{s}+R_{p}} \right| $$
折射光的偏振度为
$$P_{t}= \left| \frac{T_{s}-T_{p}}{T_{s}+T_{p}} \right| $$
由此可以看出：
- 自然光正入射（$\theta_{i}=0°$）和掠入射（$\theta=90°$）时，反射光和折射光仍是自然光。
- 自然光斜入射时，反射光和折射光都会变成部分偏振光。

当以Brewster角入射时，反射光虽然会变成完全偏振光，但是光强非常小，因此要想通过单次反射的方式得到强的高偏振度的偏振光是非常困难的。
实际工程上，经常使用片堆得到高偏振度的偏振光。如图，输入自然光与玻璃瓶呈Brewster角，每次通过一个玻璃界面，都会反射掉一部分s分量，最终通过片堆的透射光就是一个p分量的线偏振光了。
![[片堆.png]]
## 线偏振光
线偏振光入射到界面，其反射光和折射光仍为线偏振光，但其振动方向发生改变。![[线偏振光振动面的旋转.png]]
# 全反射
## 全反射的相位特性
由于全反射角公式$$\sin \theta_{C}=\frac{n_{2}}{n_{1}}$$当$\theta_{i}>\theta_{C}$时，会出现$\sin \theta_{i}> n_{2}/n_{1}$的情况，此时折射定律$n_{1}\sin \theta_{i}=n_{2}\sin \theta_{t}$不再成立了。但是为了拓展Fersnel公式的适用域，我们仍然利用关系式
$$\sin \theta_{t}= \frac{n_{1}}{n_{2}}\sin \theta_{i}$$
为此，引入虚数改写$$\cos \theta_{t}=\sqrt{ 1-\sin^2 \theta_{t} }=i\sqrt{ \sin^2 \theta_{i}-1 }=i\sqrt{ \left( \frac{n_{1}\sin \theta_{i}}{n_{2}} \right)^2 -1 }$$
代入Fersnel公式得到复数形式的反射系数
$$\tilde{r}_{s}=|\tilde{r}_{s}|e^{i\varphi_{rs}},\quad \tilde{r}_{p}=|\tilde{r}_{p}|e^{i\varphi_{rp}}$$
并且有$$|\tilde{r}_{s}|=|\tilde{r}_{p}|=1$$
一般的，s分量和p分量的变化不相同，它们之间的相位差取决于以下关系：
$$\Delta \varphi=\varphi_{rs}-\varphi_{rp}=2\arctan \frac{\cos \theta_{i}\sqrt{ \sin \theta_{i}-n^2 }}{\sin^2 \theta_{i}}$$
因此，在$n$确定的情况下，适当控制$\theta_{i}$就可以改变$\Delta \varphi$，从而改变反射光的偏振态。
- Fersnel棱镜：利用$\theta_{i}=54°37'$（或$48°37'$）时，$\Delta \varphi=45°$的关系，垂直入射振动方向与入射面法线夹角为$45°$的线偏振光，就能输出圆偏振光。
![[Fersnel棱镜.png]]
## 衰逝波
在发生全反射时，光波场将透人到第二个介质很薄的一层（约为光波波长）范围内，并沿着界面传播一段距离，再返回第一个介质。
这个透入到第二个介质中表面层内的波叫*衰逝波*（倏逝波）。
发生全反射时，光由第一个介质进入第二个介质的能量入口处和返回能量的出口处，相隔约半个波长，即如图所示，存在一个横向位移，此位移通常称为*Goos-Hanchen位移*。
![[古斯-哈恩斯位移.png]]